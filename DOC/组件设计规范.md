# 山记事 App - 组件设计规范

**版本:** 1.0  
**日期:** 2025-01-27  
**基于:** UI设计系统文档 v1.0  
**技术栈:** Expo + React Native + TypeScript + Tailwind CSS

## 目录
1. [组件架构概述](#1-组件架构概述)
2. [基础UI组件](#2-基础ui组件)
3. [业务组件](#3-业务组件)
4. [页面组件](#4-页面组件)
5. [布局组件](#5-布局组件)
6. [表单组件](#6-表单组件)
7. [导航组件](#7-导航组件)
8. [状态管理组件](#8-状态管理组件)

---

## 1. 组件架构概述

### 1.1 组件层级结构
```
components/
├── ui/                     # 基础UI组件
│   ├── Button/
│   ├── Card/
│   ├── Input/
│   ├── Icon/
│   └── Typography/
├── layout/                 # 布局组件
│   ├── DeviceFrame/
│   ├── SafeArea/
│   ├── StatusBar/
│   └── PageLayout/
├── navigation/             # 导航组件
│   ├── TabBar/
│   ├── TopBar/
│   └── BackButton/
├── business/               # 业务组件
│   ├── TaskCard/
│   ├── NoteCard/
│   ├── ProjectCard/
│   ├── PriorityDot/
│   └── SyncStatus/
├── forms/                  # 表单组件
│   ├── TaskForm/
│   ├── NoteEditor/
│   └── SearchBar/
└── pages/                  # 页面组件
    ├── SplashScreen/
    ├── OnboardingScreen/
    ├── TodoScreen/
    └── NotesScreen/
```

### 1.2 组件设计原则
- **原子设计:** 从原子→分子→组织→模板→页面的层级设计
- **单一职责:** 每个组件只负责一个特定功能
- **可复用性:** 组件可在不同上下文中复用
- **类型安全:** 使用TypeScript确保类型安全
- **性能优化:** 合理使用memo、callback和useMemo

---

## 2. 基础UI组件

### 2.1 Button 组件

#### 设计规范
```typescript
interface ButtonProps {
  variant: 'primary' | 'secondary' | 'text' | 'fab';
  size: 'sm' | 'md' | 'lg';
  onPress: () => void;
  disabled?: boolean;
  loading?: boolean;
  icon?: string;
  children: React.ReactNode;
  style?: StyleProp<ViewStyle>;
}
```

#### 视觉变体
1. **Primary Button** - 主要操作按钮
   - 背景色: `#5271FF`
   - 文字色: `#FFFFFF`
   - 圆角: `8px`
   - 高度: `48px`

2. **Secondary Button** - 次要操作按钮
   - 背景色: `transparent`
   - 边框: `1px solid #E5E7EB`
   - 文字色: `#374151`

3. **Text Button** - 文本按钮
   - 背景色: `transparent`
   - 文字色: `#5271FF`

4. **FAB Button** - 浮动操作按钮
   - 尺寸: `56px × 56px`
   - 圆角: `28px`
   - 阴影: `elevation: 6`

### 2.2 Card 组件

#### 设计规范
```typescript
interface CardProps {
  variant: 'default' | 'task' | 'note' | 'project';
  onPress?: () => void;
  shadow?: boolean;
  children: React.ReactNode;
  style?: StyleProp<ViewStyle>;
}
```

#### 视觉规范
- 背景色: `#FFFFFF`
- 圆角: `12px`
- 阴影: `0 1px 3px rgba(0, 0, 0, 0.1)`
- 边框: `1px solid #F3F4F6`
- 内边距: `16px`

### 2.3 Input 组件

#### 设计规范
```typescript
interface InputProps {
  variant: 'default' | 'search' | 'underline';
  placeholder: string;
  value: string;
  onChangeText: (text: string) => void;
  multiline?: boolean;
  numberOfLines?: number;
  icon?: string;
  error?: string;
}
```

#### 视觉状态
- **默认状态:** 边框 `#E5E7EB`
- **聚焦状态:** 边框 `#5271FF`
- **错误状态:** 边框 `#EF4444`
- **禁用状态:** 背景 `#F9FAFB`

### 2.4 Icon 组件

#### 设计规范
```typescript
interface IconProps {
  name: string;
  size?: number;
  color?: string;
  onPress?: () => void;
}
```

#### 图标映射
```typescript
const ICON_MAP = {
  // 导航类
  'home': 'fas fa-home',
  'tasks': 'fas fa-tasks',
  'notes': 'far fa-sticky-note',
  'settings': 'fas fa-cog',
  
  // 操作类
  'add': 'fas fa-plus',
  'edit': 'far fa-edit',
  'delete': 'far fa-trash-alt',
  'search': 'fas fa-search',
  'back': 'fas fa-arrow-left',
  
  // 功能类
  'calendar': 'far fa-calendar-alt',
  'clock': 'far fa-clock',
  'bell': 'far fa-bell',
  'check': 'fas fa-check',
  'sync': 'fas fa-sync',
}
```

---

## 3. 业务组件

### 3.1 TaskCard 组件

#### 功能需求
- 显示任务标题和描述
- 显示截止时间和优先级
- 支持完成状态切换
- 支持点击查看详情

#### 组件接口
```typescript
interface TaskCardProps {
  task: {
    id: string;
    title: string;
    description?: string;
    dueDate?: Date;
    priority: 'high' | 'medium' | 'low';
    completed: boolean;
    project?: string;
  };
  onToggleComplete: (id: string) => void;
  onPress: (id: string) => void;
}
```

#### 视觉元素
1. **复选框区域**
   - 未完成: 圆形边框 `#D1D5DB`
   - 已完成: 圆形背景 `#10B981` + 白色对勾

2. **内容区域**
   - 标题: `text-base font-medium`
   - 描述: `text-sm text-gray-500`
   - 时间: `text-xs text-gray-400`

3. **优先级指示器**
   - 高优先级: 红色圆点 `#EF4444`
   - 中优先级: 橙色圆点 `#F59E0B`
   - 低优先级: 绿色圆点 `#10B981`

### 3.2 NoteCard 组件

#### 功能需求
- 显示笔记标题和预览内容
- 显示创建/修改时间
- 显示所属笔记本
- 支持点击编辑

#### 组件接口
```typescript
interface NoteCardProps {
  note: {
    id: string;
    title: string;
    content: string;
    createdAt: Date;
    updatedAt: Date;
    notebook?: string;
    tags?: string[];
  };
  onPress: (id: string) => void;
  maxLines?: number;
}
```

#### 视觉规范
- 标题: `text-base font-medium mb-2`
- 预览内容: `text-sm text-gray-600 line-clamp-2`
- 元信息: `text-xs text-gray-400`

### 3.3 PriorityDot 组件

#### 功能需求
- 显示优先级颜色指示器
- 支持文字标签

#### 组件接口
```typescript
interface PriorityDotProps {
  priority: 'high' | 'medium' | 'low';
  showLabel?: boolean;
  size?: 'sm' | 'md' | 'lg';
}
```

#### 颜色映射
```typescript
const PRIORITY_COLORS = {
  high: '#EF4444',
  medium: '#F59E0B', 
  low: '#10B981',
}

const PRIORITY_LABELS = {
  high: '高优先级',
  medium: '中优先级',
  low: '低优先级',
}
```

### 3.4 SyncStatus 组件

#### 功能需求
- 显示同步状态
- 支持不同的视觉状态

#### 组件接口
```typescript
interface SyncStatusProps {
  status: 'connected' | 'syncing' | 'error' | 'offline';
  service?: string;
  lastSyncTime?: Date;
}
```

#### 状态样式
```typescript
const STATUS_STYLES = {
  connected: {
    bg: 'bg-green-100',
    text: 'text-green-600',
    icon: 'fas fa-check-circle'
  },
  syncing: {
    bg: 'bg-blue-100',
    text: 'text-blue-600',
    icon: 'fas fa-sync fa-spin'
  },
  error: {
    bg: 'bg-red-100',
    text: 'text-red-600',
    icon: 'fas fa-exclamation-circle'
  },
  offline: {
    bg: 'bg-gray-100',
    text: 'text-gray-600',
    icon: 'fas fa-wifi-slash'
  }
}
```

---

## 4. 页面组件

### 4.1 SplashScreen 组件

#### 功能需求
- 显示应用Logo和名称
- 加载应用初始化数据
- 自动跳转到主页面或引导页

#### 视觉规范
- 背景: 渐变色或纯色 `#F5F7FA`
- Logo: `text-6xl` 山图标
- 应用名称: `text-3xl font-bold`
- 标语: `text-gray-500`

#### 组件结构
```typescript
interface SplashScreenProps {
  onComplete: () => void;
}

const SplashScreen: React.FC<SplashScreenProps> = ({ onComplete }) => {
  // 实现逻辑
}
```

### 4.2 OnboardingScreen 组件

#### 功能需求
- 展示应用核心功能
- 轮播式介绍页面
- 支持跳过和下一步

#### 轮播内容配置
```typescript
const ONBOARDING_SLIDES = [
  {
    icon: 'fas fa-clipboard-list',
    title: '高效管理待办事项',
    description: '轻松创建任务，设置优先级和截止日期，让您的生活更有条理'
  },
  {
    icon: 'fas fa-sticky-note',
    title: '随时记录灵感',
    description: '支持富文本编辑，快速记录想法，支持Markdown格式'
  },
  {
    icon: 'fas fa-shield-alt',
    title: '数据安全可控',
    description: '本地优先存储，多种同步方式，您的数据您做主'
  }
]
```

### 4.3 TodoScreen 组件

#### 功能结构
```typescript
interface TodoScreenProps {
  // 页面props
}

const TodoScreen: React.FC<TodoScreenProps> = () => {
  // 状态管理
  const [selectedTab, setSelectedTab] = useState('today');
  const [tasks, setTasks] = useState<Task[]>([]);
  const [loading, setLoading] = useState(false);
  
  // 组件结构
  return (
    <PageLayout>
      <TopBar title="待办事项" />
      <TabSelector tabs={['今天', '全部', '已完成']} />
      <TaskList tasks={tasks} />
      <FAButton onPress={handleCreateTask} />
    </PageLayout>
  );
}
```

#### 子组件
1. **TabSelector** - 选项卡切换器
2. **TaskList** - 任务列表容器  
3. **TaskCard** - 任务卡片
4. **FAButton** - 浮动操作按钮

### 4.4 NotesScreen 组件

#### 功能结构
```typescript
const NotesScreen: React.FC = () => {
  const [viewMode, setViewMode] = useState<'list' | 'grid'>('list');
  const [notes, setNotes] = useState<Note[]>([]);
  
  return (
    <PageLayout>
      <TopBar title="笔记" />
      <ViewToggle mode={viewMode} onToggle={setViewMode} />
      <NoteList notes={notes} viewMode={viewMode} />
      <FAButton onPress={handleCreateNote} />
    </PageLayout>
  );
}
```

---

## 5. 布局组件

### 5.1 DeviceFrame 组件

#### 功能需求
- 模拟设备外观
- 处理安全区域
- 响应式适配

#### 组件接口
```typescript
interface DeviceFrameProps {
  children: React.ReactNode;
  device?: 'iphone' | 'android';
}
```

### 5.2 PageLayout 组件

#### 功能需求
- 统一页面布局结构
- 处理键盘避让
- 管理加载状态

#### 组件结构
```typescript
interface PageLayoutProps {
  children: React.ReactNode;
  showTabBar?: boolean;
  loading?: boolean;
  refreshing?: boolean;
  onRefresh?: () => void;
}

const PageLayout: React.FC<PageLayoutProps> = ({
  children,
  showTabBar = true,
  loading,
  refreshing,
  onRefresh
}) => {
  return (
    <SafeAreaView style={{ flex: 1 }}>
      <StatusBar />
      <View style={{ flex: 1 }}>
        {loading ? <LoadingSpinner /> : children}
      </View>
      {showTabBar && <TabBar />}
    </SafeAreaView>
  );
}
```

### 5.3 SafeArea 组件

#### 功能需求
- 处理设备安全区域
- 适配不同设备型号
- 支持自定义内边距

---

## 6. 表单组件

### 6.1 TaskForm 组件

#### 功能需求
- 任务创建和编辑表单
- 字段验证
- 数据持久化

#### 表单字段
```typescript
interface TaskFormData {
  title: string;
  description?: string;
  dueDate?: Date;
  dueTime?: Date;
  priority: Priority;
  projectId?: string;
  reminders?: Date[];
  recurring?: RecurringConfig;
}
```

#### 组件结构
```typescript
const TaskForm: React.FC<TaskFormProps> = ({ task, onSave, onCancel }) => {
  const [formData, setFormData] = useState<TaskFormData>(initialData);
  const [errors, setErrors] = useState<ValidationErrors>({});
  
  return (
    <ScrollView>
      <Input 
        label="任务标题"
        value={formData.title}
        onChangeText={(title) => setFormData({...formData, title})}
        error={errors.title}
      />
      <Input 
        label="任务描述"
        multiline
        value={formData.description}
        onChangeText={(description) => setFormData({...formData, description})}
      />
      <DatePicker 
        label="截止日期"
        value={formData.dueDate}
        onChange={(dueDate) => setFormData({...formData, dueDate})}
      />
      <PrioritySelector 
        value={formData.priority}
        onChange={(priority) => setFormData({...formData, priority})}
      />
      <ProjectSelector 
        value={formData.projectId}
        onChange={(projectId) => setFormData({...formData, projectId})}
      />
    </ScrollView>
  );
}
```

### 6.2 NoteEditor 组件

#### 功能需求
- 富文本编辑
- Markdown支持
- 自动保存草稿
- 工具栏操作

#### 组件接口
```typescript
interface NoteEditorProps {
  note?: Note;
  onSave: (note: Partial<Note>) => void;
  onCancel: () => void;
  autoSave?: boolean;
}
```

#### 工具栏配置
```typescript
const TOOLBAR_ACTIONS = [
  { key: 'bold', icon: 'fas fa-bold', action: 'bold' },
  { key: 'italic', icon: 'fas fa-italic', action: 'italic' },
  { key: 'underline', icon: 'fas fa-underline', action: 'underline' },
  { key: 'list', icon: 'fas fa-list-ul', action: 'unorderedList' },
  { key: 'numberedList', icon: 'fas fa-list-ol', action: 'orderedList' },
  { key: 'link', icon: 'fas fa-link', action: 'link' },
  { key: 'image', icon: 'fas fa-image', action: 'image' },
]
```

### 6.3 SearchBar 组件

#### 功能需求
- 实时搜索
- 搜索历史
- 语音输入支持

#### 组件接口
```typescript
interface SearchBarProps {
  placeholder: string;
  onSearch: (query: string) => void;
  onFocus?: () => void;
  onBlur?: () => void;
  showHistory?: boolean;
  recentSearches?: string[];
}
```

---

## 7. 导航组件

### 7.1 TabBar 组件

#### 功能需求
- 底部导航栏
- 激活状态指示
- 徽章数字显示

#### 标签页配置
```typescript
const TAB_CONFIG = [
  {
    key: 'todos',
    label: '待办事项',
    icon: 'fas fa-tasks',
    badge?: number,
  },
  {
    key: 'notes', 
    label: '笔记',
    icon: 'far fa-sticky-note',
  },
  {
    key: 'settings',
    label: '设置',
    icon: 'fas fa-cog',
  }
]
```

### 7.2 TopBar 组件

#### 功能需求
- 页面标题显示
- 返回按钮
- 操作按钮

#### 组件接口
```typescript
interface TopBarProps {
  title: string;
  showBack?: boolean;
  onBack?: () => void;
  actions?: TopBarAction[];
}

interface TopBarAction {
  icon: string;
  onPress: () => void;
  badge?: number;
}
```

---

## 8. 状态管理组件

### 8.1 LoadingSpinner 组件

#### 视觉规范
- 尺寸: `24px`
- 颜色: `#5271FF`
- 动画: 旋转动画 1秒一周期

### 8.2 EmptyState 组件

#### 功能需求
- 显示空状态提示
- 引导用户操作

#### 组件接口
```typescript
interface EmptyStateProps {
  icon: string;
  title: string;
  description?: string;
  actionText?: string;
  onAction?: () => void;
}
```

### 8.3 ErrorBoundary 组件

#### 功能需求
- 捕获组件错误
- 显示友好错误页面
- 提供重试机制

---

## 总结

本组件设计规范文档提供了山记事App所需的完整组件体系，涵盖了从基础UI组件到复杂业务组件的设计规范。每个组件都遵循以下原则：

1. **统一性:** 与UI设计系统保持一致
2. **可复用性:** 组件可在不同场景中复用
3. **类型安全:** 完整的TypeScript类型定义
4. **性能优化:** 合理的组件拆分和优化策略
5. **可维护性:** 清晰的组件结构和接口设计

开发团队可以基于这些规范进行组件实现，确保代码质量和用户体验的一致性。 